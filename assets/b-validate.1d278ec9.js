import{i as O}from"./lodash.isequal.878bd568.js";var l=Object.prototype.toString;function y(i){return l.call(i)==="[object Array]"}function g(i){return l.call(i)==="[object Object]"}function v(i){return l.call(i)==="[object String]"}function x(i){return l.call(i)==="[object Number]"&&i===i}function _(i){return l.call(i)==="[object Boolean]"}function f(i){return i==null||i===""}function E(i){return y(i)&&!i.length}function S(i){return g(i)&&!Object.keys(i).length}var p=function(t,r){g(r)&&v(t)&&r.trim?this.obj=t.trim():g(r)&&r.ignoreEmptyString&&t===""?this.obj=void 0:this.obj=t,v(r.message)&&(this.message=r.message),this.type=r.type,this.error=null},d={not:{configurable:!0},isRequired:{configurable:!0},end:{configurable:!0}};d.not.get=function(){return this._not=!this._not,this};d.isRequired.get=function(){return(f(this.obj)||E(this.obj))&&(this.error={value:this.obj,type:this.type,requiredError:!0,message:this.message||""+(this._not?"[NOT MODE]:":"")+this.type+" is required"}),this};d.end.get=function(){return this.error};p.prototype.addError=function(t){!this.error&&t&&(this.error={value:this.obj,type:this.type,message:this.message||""+(this._not?"[NOT MODE]:":"")+t})};p.prototype.validate=function(t,r){var o=this._not?t:!t;return o&&this.addError(r),this};p.prototype.collect=function(t){t&&t(this.error)};Object.defineProperties(p.prototype,d);var q=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"string"})),this.validate(e&&e.strict?v(this.obj):!0,"Expect string type but got "+typeof this.obj)}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={uppercase:{configurable:!0},lowercase:{configurable:!0}};return t.prototype.maxLength=function(e){return this.obj?this.validate(this.obj.length<=e,"Expect max length "+e+" but got "+this.obj.length):this},t.prototype.minLength=function(e){return this.obj?this.validate(this.obj.length>=e,"Expect min length "+e+" but got "+this.obj.length):this},t.prototype.length=function(e){return this.obj?this.validate(this.obj.length===e,"Expect length "+e+" but got "+this.obj.length):this},t.prototype.match=function(e){var n=e instanceof RegExp;return n&&(e.lastIndex=0),this.validate(this.obj===void 0||n&&e.test(this.obj),"`"+this.obj+"` is not match pattern "+e)},r.uppercase.get=function(){return this.obj?this.validate(this.obj.toUpperCase()===this.obj,"Expect `"+this.obj+"` to be uppercased"):this},r.lowercase.get=function(){return this.obj?this.validate(this.obj.toLowerCase()===this.obj,"Expect `"+this.obj+"` to be lowercased"):this},Object.defineProperties(t.prototype,r),t}(p),w=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"number"})),this.validate(e&&e.strict?x(this.obj):!0,"Expect number type but got "+typeof this.obj)}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={positive:{configurable:!0},negative:{configurable:!0}};return t.prototype.min=function(e){return f(this.obj)?this:this.validate(this.obj>=e,"`"+this.obj+"` is not greater than `"+e+"`")},t.prototype.max=function(e){return f(this.obj)?this:this.validate(this.obj<=e,"`"+this.obj+"` is not less than `"+e+"`")},t.prototype.equal=function(e){return f(this.obj)?this:this.validate(this.obj===e,"`"+this.obj+"` is not equal to `"+e+"`")},t.prototype.range=function(e,n){return f(this.obj)?this:this.validate(this.obj>=e&&this.obj<=n,"`"+this.obj+"` is not in range `"+e+" ~ "+n+"`")},r.positive.get=function(){return f(this.obj)?this:this.validate(this.obj>0,"Expect number to be positive, but got `"+this.obj+"`")},r.negative.get=function(){return f(this.obj)?this:this.validate(this.obj<0,"Expect number to be negative, but got `"+this.obj+"`")},Object.defineProperties(t.prototype,r),t}(p),V=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"array"})),this.validate(e&&e.strict?y(this.obj):!0,"Expect array type but got `"+this.obj+"`")}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={empty:{configurable:!0}};return t.prototype.length=function(e){return this.obj?this.validate(this.obj.length===e,"Expect array length "+e+" but got "+this.obj.length):this},t.prototype.minLength=function(e){return this.obj?this.validate(this.obj.length>=e,"Expect min array length "+e+" but got "+this.obj.length):this},t.prototype.maxLength=function(e){return this.obj?this.validate(this.obj.length<=e,"Expect max array length "+e+" but got "+this.obj.length):this},t.prototype.includes=function(e){var n=this;return this.obj?this.validate(e.every(function(h){return n.obj.indexOf(h)!==-1}),JSON.stringify(this.obj)+" is not includes "+JSON.stringify(e)):this},t.prototype.deepEqual=function(e){return this.obj?this.validate(O(this.obj,e),JSON.stringify(this.obj)+" is not deep equal with "+JSON.stringify(e)):this},r.empty.get=function(){return this.validate(E(this.obj),"Expect empty array but got "+JSON.stringify(this.obj))},Object.defineProperties(t.prototype,r),t}(p),A=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"object"})),this.validate(e&&e.strict?g(this.obj):!0,"Expect object type but got `"+this.obj+"`")}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={empty:{configurable:!0}};return t.prototype.deepEqual=function(e){return this.obj?this.validate(O(this.obj,e),JSON.stringify(this.obj)+" is not deep equal with "+JSON.stringify(e)):this},t.prototype.hasKeys=function(e){var n=this;return this.obj?this.validate(e.every(function(h){return n.obj[h]}),JSON.stringify(this.obj)+" is not has keys "+e):this},r.empty.get=function(){return this.validate(S(this.obj),"Expect empty object but got "+JSON.stringify(this.obj))},Object.defineProperties(t.prototype,r),t}(p),N=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"boolean"})),this.validate(e&&e.strict?_(this.obj):!0,"Expect boolean type but got "+typeof this.obj)}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={true:{configurable:!0},false:{configurable:!0}};return r.true.get=function(){return this.validate(this.obj===!0,"Expect true but got false")},r.false.get=function(){return this.validate(this.obj===!1,"Expect false but got true")},Object.defineProperties(t.prototype,r),t}(p),J=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,L=new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-?)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),P=/^(2(5[0-5]{1}|[0-4]\d{1})|[0-1]?\d{1,2})(\.(2(5[0-5]{1}|[0-4]\d{1})|[0-1]?\d{1,2})){3}$/,$=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"type"}))}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={email:{configurable:!0},url:{configurable:!0},ip:{configurable:!0}};return r.email.get=function(){return this.validate(this.obj===void 0||J.test(this.obj),"Expect type email but got `"+this.obj+"`")},r.url.get=function(){return this.validate(this.obj===void 0||L.test(this.obj),"Expect type url but got `"+this.obj+"`")},r.ip.get=function(){return this.validate(this.obj===void 0||P.test(this.obj),"Expect type ip but got `"+this.obj+"`")},Object.defineProperties(t.prototype,r),t}(p),z=function(i){function t(o,e){i.call(this,o,Object.assign({},e,{type:"custom"}))}i&&(t.__proto__=i),t.prototype=Object.create(i&&i.prototype),t.prototype.constructor=t;var r={validate:{configurable:!0}};return r.validate.get=function(){var o=this;return function(e,n){var h;if(e)return h=e(o.obj,o.addError.bind(o)),h&&h.then?(n&&h.then(function(){n&&n(o.error)},function(s){console.error(s)}),[h,o]):(n&&n(o.error),this.error)}},Object.defineProperties(t.prototype,r),t}(p),m=function(t,r){this.string=new q(t,r),this.number=new w(t,r),this.array=new V(t,r),this.object=new A(t,r),this.boolean=new N(t,r),this.type=new $(t,r),this.custom=new z(t,r)},R=function(t,r){r===void 0&&(r={}),this.schema=t,this.options=r};R.prototype.validate=function(t,r){var o=this;if(!g(t))return;var e=[],n=null;function h(s,u){n||(n={}),(!n[s]||u.requiredError)&&(n[s]=u)}this.schema&&Object.keys(this.schema).forEach(function(s){y(o.schema[s])&&o.schema[s].forEach(function(u){var b=u.type,j=u.message,a;if(!b&&!u.validator)throw"You must specify a type to field "+s+"!";if(b==="email"||b==="url"||b==="ip")a=new m(t[s],Object.assign({},o.options,{message:j})).type[b];else if(u.validator){a=new m(t[s],Object.assign({},o.options,{message:j})).custom.validate(u.validator),Object.prototype.toString.call(a)==="[object Array]"&&a[0].then?e.push({function:a[0],_this:a[1],key:s}):a&&h(s,a);return}else a=new m(t[s],Object.assign({},o.options,{message:j}))[b];Object.keys(u).forEach(function(c){u.required&&(a=a.isRequired),a[c]&&u[c]&&typeof a[c]=="object"&&(a=a[c]),a[c]&&u[c]!==void 0&&typeof a[c]=="function"&&(a=a[c](u[c]))}),a.collect(function(c){c&&h(s,c)})})}),e.length>0?Promise.all(e.map(function(s){return s.function})).then(function(){e.forEach(function(s){s._this.error&&h(s.key,s._this.error)}),r&&r(n)}):r&&r(n)};export{R as S};
